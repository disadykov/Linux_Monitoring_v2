# Part 7. Prometheus and Grafana


## Установить и настроить **Prometheus** и **Grafana** на виртуальную машину

Работы проводим на виртуальной машине с ОС **`Ubuntu 22.04.2 LTS`**.

  ![vbox](src/07/img/1-1.png "Виртуальная машина")

Для удобства работы подключимся с локальной машины к виртуальной по `SSH`

  ![ssh](src/07/img/1-2.png "Подключение по ssh")

Установка **Prometheus** командой `sudo apt-get install prometheus`
  ![Prometheus](src/07/img/1-3.png "Установка Prometheus")

Установка **Grafana** командой `sudo snap install grafana`

  ![Grafana](src/07/img/1-4.png "Установка Prometheus")

Для подключения к веб интерфесам **Prometheus** и **Grafana** с локальной машины потребуется проброска портов (*9090 - Prometheus* и *3000 - Grafana* ) в VBox для виртуальной машины:

  ![Ports](src/07/img/1-5.png "Проброска портов")


#### 
-------------------------

## Получить доступ к веб интерфейсам Prometheus и Grafana с локальной машины

Проверим доступ через веб-интерфейс с локальной машины:
  
  ![web](src/07/img/1-6.png "Доступ через веб-интерфейс")

Так же можно подключиться к веб интерфейсу с любой другой машины, если виртуальная машина включена в локальную сеть:

  ![web](src/07/img/1-7.png "Доступ через веб-интерфейс")

#### 
-------------------------

## Добавить на дашборд **Grafana** отображение ЦПУ, доступной оперативной памяти, свободное место и кол-во операций ввода/вывода на жестком диске

Добавлены метрики в настройках Дашборда:

  ![DB](src/07/img/1-8.png "Метрики Дашборда")

Настройки дашборда и всех метрик сохранены в файл **`Dashboard.json`**. (Можно сделать импорт настроек из файла)

#### 
-------------------------

## Запустить ваш bash-скрипт из Части 2. Посмотреть на нагрузку жесткого диска (место на диске и операции чтения/записи)

Запустим скрипт из части 2 и проверим показатели на дашборде:

  ![DB2](src/07/img/1-10.png "Метрики Дашборда")

#### 
-------------------------

## Установить утилиту stress и запустить команду `stress -c 2 -i 1 -m 1 --vm-bytes 32M -t 10s`. Посмотреть на нагрузку жесткого диска, оперативной памяти и ЦПУ

Установка утилиты **stress** командой `apt-get install stress`

  ![stress](src/07/img/1-11.png "Установка утилиты")

Запуск команды: `stress -c 2 -i 1 -m 1 --vm-bytes 32M -t 10s` и изменения на дашборде:

  ![stress2](src/07/img/1-12.png "Запуск утилиты")